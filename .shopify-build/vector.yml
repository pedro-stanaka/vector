containers:
  default:
    docker: cimg/rust:1.64.0-node

steps:
  - label: Prepare and Build Vector
    timeout: 120m
    run:
    - bash scripts/environment/install-protoc.sh
    - rustup target add x86_64-unknown-linux-gnu
    # - make package-x86_64-unknown-linux-gnu-all
    - PATH="$PATH:$(pwd)/bin" cargo build --target=x86_64-unknown-linux-gnu --release
    cache:
    - ~/.cargo/registry
    - ~/.cargo/git
    - target